# Marinewatch

## Developer setup

### Requirements

- rbenv
- docker

### Project setup

#### Go to the project directory

    git clone git@github.com:fogglyorg/marinewatch.git
    cd marinewatch

#### Start docker containers

    docker-compose up -d

#### Install the required version of Ruby

    rbenv install
    rbenv rehash

#### Install Bundler

    gem install bundler
    rbenv rehash

#### Install required gems for the web api
    cd ./code/web_api
    bundle install
    rbenv rehash


## Project Overview

### Technologies

- Docker as containers manager
- Batch processing using Spark and HDFS (in Scala)
- Neo4j as graph database
- Web API built in Ruby (using Sinatra to define the API)
- CLI tool written in pure bash
- Git as versioning system

### Architecture

- `code/`: contains all the marinewatch code
  - `csvformatter` Spark Scala application used to generate structured data to be imported in Neo4j
  - `web_api` Web API to get shortest path between two geo coordinates
- `data/`: contains all data files
  - `input` Data files used by Spark jobs
  - `output` Data files generated by Spark jobs
- `neo4j/`:
  - `conf`: Neo4j config files
  - `data`: Neo4j databases
  - `logs`: Logs generated by Neo4j
  - `plugins`: Plugins used by Neo4j
- `docker-compose.yml`: Docker config file
- `marinewatch-cli`: CLI tool used to manage the app

## How it works

**Important:**

- You need to have docker running

#### Build and run Spark job

    ./marinewatch-cli -b

#### Create Neo4j database

    ./marinewatch-cli -u dbname
    # To update default db name in Neo4j change this line in neo4j/conf/neo4j.conf
    # dbms.active_database=dbname.db
    # and restart the container
    # docker restart marinewatch_neo4j_1

#### Start web API

    ./marinewatch-cli -s
    # You can try to get the KML result from this endpoint for example
    # http://localhost:4567/route?from=39.4,6.8&to=11.6,96.0

#### All in one command

    ./marinewatch-cli -bsu dbname

## Improvements to do

- Improve speed
- Use datasets with better accuracy (1/40)
- Do not restrict cost (used by dijkstra algorithm) to boats density
- Add Spark Streaming processing
- ...

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
